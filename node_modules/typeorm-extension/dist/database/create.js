"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createDatabase = void 0;
const errors_1 = require("../errors");
const driver_1 = require("./driver");
const utils_1 = require("./utils");
/**
 * Create database for specified driver in ConnectionOptions.
 *
 * @throws DriverError
 * @throws OptionsError
 *
 * @param context
 */
async function createDatabase(context) {
    context = await (0, utils_1.buildDatabaseCreateContext)(context);
    if (!context.options) {
        throw errors_1.OptionsError.undeterminable();
    }
    if (!context.options.type) {
        throw errors_1.DriverError.undeterminable();
    }
    switch (context.options.type) {
        case 'mysql':
        case 'mariadb':
            return (0, driver_1.createMySQLDatabase)(context);
        case 'postgres':
            return (0, driver_1.createPostgresDatabase)(context);
        case 'cockroachdb':
            return (0, driver_1.createCockroachDBDatabase)(context);
        case 'sqlite':
        case 'better-sqlite3':
            return (0, driver_1.createSQLiteDatabase)(context);
        case 'oracle':
            return (0, driver_1.createOracleDatabase)(context);
        case 'mssql':
            return (0, driver_1.createMsSQLDatabase)(context);
    }
    throw errors_1.DriverError.notSupported(context.options.type);
}
exports.createDatabase = createDatabase;
